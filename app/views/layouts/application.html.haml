!!!
%html
  %head
    %title Pin.DoIt
    = stylesheet_link_tag    'application', media: 'all'
    = stylesheet_link_tag    'flaticon/flaticon.css'
    = javascript_include_tag 'application'
    = csrf_meta_tags
    = favicon_link_tag 'favicon.png'
  %body
    .sidebar-icons
      %a.sidebar-toggler
        .profile
          = image_tag "//placehold.it/50x50"
      .navicons
        - if current_user
          = link_to '#' do
            %span.flaticon-home7
          = link_to '#' do
            %span.flaticon-flag9
          = link_to '#' do
            %span.flaticon-check6
          = link_to '#' do
            %span.flaticon-lock9
        - else
          = link_to '#', data: {target: "#login", toggle: "modal"} do
            %span.flaticon-clock6
          = link_to '#', data: {target: "#register", toggle: "modal"} do
            %span.flaticon-clock6

    .sidebar
      .user
        - if current_user
          .name
            John Smith
          .username
            (jsmith)
        - else
          .name
            Guest User
          .username
            Please Login
      .sidenav
        - if current_user
          = link_to :dashboard do
            Home
          = link_to '#' do
            My Pins
          = link_to '#' do
            Do it
          = link_to '#' do
            Graveyard
          = link_to '#' do
            Calendar
          = link_to '#' do
            Scoreboard
          = link_to :logout do
            Logout
        - else
          = link_to '#', data: {target: "#login", toggle: "modal"} do
            Log In
          = link_to '#', data: {target: "#register", toggle: "modal"} do
            Register
    .body-wrapper
      %nav.navbar.navbar-inverse
        .container
          .navbar-header
            %button.navbar-toggle{"data-target" => "#navbar-collapse", "data-toggle" => "collapse", type: "button"}
              %span.sr-only Toggle navigation
              %span.icon-bar
              %span.icon-bar
              %span.icon-bar

            .navbar-brand
              = link_to root_path do
                = image_tag("//placehold.it/180x40")

            #search.search.search-open
              %form
                %input#search.search-input{:name => "search", :placeholder => "Enter your search term...", :type => "search", :value => ""}/
                %input.search-submit{:type => "submit", :value => ""}/
                %span.sb-icon-search
                  .fa.fa-search

          #navbar-collapse.collapse.navbar-collapse.pull-right
            %ul.nav.navbar-nav.navbar-right
              - if current_user
                %li.divider-vertical
                %li
                  = link_to '#' do
                    %span.flaticon-calendar7
                %li
                  = link_to '#' do
                    %span.flaticon-calendar7
                %li= link_to "Logout", :logout
              - else
                %li.divider-vertical
                %li
                  = link_to '#', data: {target: "#register", toggle: "modal"} do
                    Register
                %li.divider-vertical
                %li
                  = link_to '#', data: {target: "#login", toggle: "modal"} do
                    Log In

          .pinned-toggler.pull-right
            %input{:checked => "checked", :name => "my-checkbox", :type => "checkbox"}

      / - if notice
      /   .alert.alert-warning
      /     %a.close{"data-dismiss" => "alert", :href => "#"} ×
      /     = notice

      .content-wrapper
        = yield

    #login.modal.fade
      .modal-dialog
        .modal-content
          .modal-header
            %button.close{"aria-label" => "Close", "data-dismiss" => "modal", :type => "button"}
              %span{"aria-hidden" => "true"} ×
            %h4.modal-title Log In

          = form_for UserSession.new do |f|
            .modal-body
              .field
                = f.label :username
                = f.text_field :username, class: "form-control", id: "login_username"
              .field
                = f.label :password
                = f.password_field :password, class: "form-control"
            .modal-footer
              .actions
                = f.submit 'Log In', class: "btn btn-success"
                %button.btn.btn-danger{"data-dismiss" => "modal", :type => "button"} Cancel

    #register.modal.fade
      .modal-dialog
        .modal-content
          .modal-header
            %button.close{"aria-label" => "Close", "data-dismiss" => "modal", :type => "button"}
              %span{"aria-hidden" => "true"} ×
            %h4.modal-title Register
          = form_for User.new do |f|

            - if !params[:organization_token].nil?
              = hidden_field :organization_token, value: params[:organization_token]

            .modal-body.row
              .field.col-xs-6
                = f.label :username
                = f.text_field :username, class: "form-control", id: "register_username"
              .field.col-xs-6
                = f.label :email
                = f.text_field :email, class: "form-control"
              .field.col-xs-6
                = f.label :first_name
                = f.text_field :first_name, class: "form-control"
              .field.col-xs-6
                = f.label :last_name
                = f.text_field :last_name, class: "form-control"
              .field.col-xs-6
                = f.label :password
                = f.password_field :password, class: "form-control"
              .field.col-xs-6
                = f.label :password_confirmation
                = f.password_field :password_confirmation, class: "form-control"
              .field.col-xs-12
                = f.label :organization_name
                = f.text_field :organization_name, class: "form-control"
              %hr
              .field.col-xs-12
                = check_box_tag("user[is_manager]", "1", false, class: "checkbox")
                = label_tag :checkbox, "I am the manager of this organization."
              %h5.text-center
                %b OR
              .field.col-xs-12
                = f.label 'Organization access token'
                = f.text_field :organization_token, class: "form-control"
            .modal-footer
              .actions
                = f.submit 'Register', class: "btn btn-success"
                %button.btn.btn-danger{"data-dismiss" => "modal", :type => "button"} Cancel

    #post-discussion.modal.fade
      .modal-dialog
        .modal-content
          .modal-header
            %button.close{"aria-label" => "Close", "data-dismiss" => "modal", :type => "button"}
              %span{"aria-hidden" => "true"} ×
            %h4.modal-title
              Post Title Discussion
          .modal-body.row
            = form_for Comment.new do |f|
              = f.hidden_field :suggestion, value: false
              .field.col-xs-12
                = f.text_area :content, class: "form-control", placeholder: "Enter your comment here ...", rows: 3
              / .field.col-xs-12.text-right
              /   = check_box_tag("comment[anonymous]", "1", false, class: "checkbox")
              /   = label_tag :checkbox, "Remain Anonymous"
              .actions.col-xs-12.text-right
                = f.submit 'Post Plain Comment', class: "btn btn-warning", id: "comment_plain"
                = f.submit 'Post as Suggestion', class: "btn btn-custom", id: "comment_suggestion"
          .modal-footer
            .comment-sorts
              = link_to '#' do
                .btn.btn-sm.btn-custom
                  NEWEST
              = link_to '#' do
                .btn.btn-sm.btn-success.btn-off
                  MOST UPVOTED
            .comment-filters
              = link_to '#' do
                .btn.btn-sm.btn-success
                  ALL
              = link_to '#' do
                .btn.btn-sm.btn-warning.btn-off
                  PLAIN
              = link_to '#' do
                .btn.btn-sm.btn-custom.btn-off
                  SUGGESTION
            = render "comments/card"
            = render "comments/card"
