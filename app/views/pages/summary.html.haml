= javascript_include_tag 'util/analytics_d3'

.summary
  #analytics-carousel.carousel.slide{"data-ride" => "carousel", "data-interval" => "false"}
    %ul.alt-indicators
      %li
        %p
          From:
          %b July 02, 2015
          %span.fa.fa-edit
      %li
        %p
          To:
          %b July 08, 2015
          %span.fa.fa-edit
    %ul.carousel-indicators
      %li.active{"data-slide-to" => "0", "data-target" => "#analytics-carousel"}
        .headline Departments
        /.subline by Department
      %li{"data-slide-to" => "1", "data-target" => "#analytics-carousel"}
        .headline Employees
        /.subline by Employee
      %li{"data-slide-to" => "2", "data-target" => "#analytics-carousel"}
        .headline Trending
        /.subline in the Pipline
      %li{"data-slide-to" => "3", "data-target" => "#analytics-carousel"}
        .headline Approved
        /.subline launched Actionables
      %li{"data-slide-to" => "4", "data-target" => "#analytics-carousel"}
        .headline Insights
        /.subline on Idea Generation
    / Wrapper for slides
    .carousel-inner{:role => "listbox"}
      .item.active
        .row.first-q
          .col-sm-6
            .summary-box
              .header Top Departments
              .body
                - @contributions_by_department[0..5].each do |entry|
                  .col-sm-4
                    .summary-card
                      .footer
                        = entry['Department']
                      .main-content
                        = entry['# Ideas Actionable']
                        /:escaped
                        /  /
                        /#{entry['# Ideas Total']}
                      .notes
                        Viable Ideas

          .col-sm-6
            .summary-box
              .header Department Contributions
              .body
                #contributions_by_department_graph.d3_graph
        .row
          .analytics_data_table_wrapper
            %table.analytics_data_table.table.table-striped.display{cellspacing: "0", width: "100%"}
              %thead.text-center
                %th Department
                %th Viable Ideas
                %th Total Ideas
                %th Approved Ideas
                %th Total Comments
                %th Total Votes
                %th Total Users
              %tbody.text-center
                - @contributions_by_department.each do |entry|
                  %tr
                    %td= entry['Department']
                    %td= entry['# Ideas Actionable']
                    %td= entry['# Ideas Total']
                    %td= entry['# Ideas Approved']
                    %td= entry['# of Comments']
                    %td= entry['# of Votes']
                    %td= entry['# of Users']
      .item
        .row.first-q
          .col-sm-6
            .summary-box
              .header Top Idea Contributors (Viable/Total)
              .body
                - @contributions_by_employee[0..5].each do |entry|
                  .col-sm-4
                    .summary-card
                      .main-content.sm
                        = entry['# Ideas Actionable']
                        :escaped
                          /
                        #{entry['# Ideas Total']}
                      /.notes
                      /  Viable Ideas - Total
                      .footer
                        - user = User.find(entry['user_id'])
                        - if !user || user.picture.nil?
                          = image_tag("profile_default.png")
                        - else
                          = image_tag user.picture.image.url(:user_image)
                        = entry['Name']
          .col-sm-6
            .summary-box
              .header Employee Contributions
              .body
                #contributions_by_employee_graph.d3_graph
        .row
          .col-xs-12.analytics_data_table_wrapper
            %table.analytics_data_table.table.table-striped.display{cellspacing: "0", width: "100%"}
              %thead.text-center
                %th Name
                %th Score
                %th Viable Ideas
                %th Total Ideas
                %th Approved Ideas
                %th Comments Received
                %th Comments Given
                %th Votes Received
                %th Votes Given
              %tbody.text-center
                - @contributions_by_employee.each do |entry|
                  %tr
                    %td= entry['Name']
                    %td
                      = (1.0 * entry['# Ideas Actionable'] + 0.5 * entry['# Ideas Approved'] + 0.2 * (entry['# of Comments Received'] + entry['# of Comments Given']) + 0.1 * (entry['# of Votes Received'] + entry['# of Votes Given'])).round(1)
                    %td= entry['# Ideas Actionable']
                    %td= entry['# Ideas Total']
                    %td= entry['# Ideas Approved']
                    %td= entry['# of Comments Received']
                    %td= entry['# of Comments Given']
                    %td= entry['# of Votes Received']
                    %td= entry['# of Votes Given']
      .item
        .row.first-q
          .col-xs-12.col-sm-6
            .summary-box
              .header Trending Ideas (By Support)
              .body
                - @trending_ideas[0..5].each do |entry|
                  .col-sm-4
                    .summary-card
                      .main-content.sm
                        #{entry['Support']}%
                      .notes.post
                      .footer
                        = entry['Title']
          .col-xs-12.col-sm-6
            .summary-box
              .header Chart
              .body
                #trending_ideas_graph.d3_graph
        .row
          .col-xs-12.analytics_data_table_wrapper
            %table.analytics_data_table.table.table-striped.display{cellspacing: "0", width: "100%"}
              %thead.text-center
                %th Poster
                %th Title
                %th Support
                %th Total Comments
                %th Total Votes
              %tbody.text-center
                - @trending_ideas.each do |entry|
                  %tr
                    %td= entry['Poster']
                    %td= entry['Title']
                    %td #{entry['Support']}%
                    %td= entry['# of Comments']
                    %td= entry['# of Votes']
      .item
        .row.first-q
          .col-sm-6
            .summary-box
              .header Approved Ideas
              .body
                - @approved_ideas[0..5].each do |entry|
                  .col-sm-4
                    .summary-card
                      .main-content.sm
                      .notes.post
                        %b= entry['Title']
                        %br
                        (#{entry['Support']}% Support)
                      .footer
                        = entry['Poster']
          .col-sm-6
            .summary-box
              .header Chart
              .body
                #approved_ideas_graph.d3_graph
        .row
          .col-xs-12.analytics_data_table_wrapper
            %table.analytics_data_table.table.table-striped.display{cellspacing: "0", width: "100%"}
              %thead.text-center
                %th Poster
                %th Title
                %th Support
                %th Total Comments
                %th Total Votes
              %tbody.text-center
                - @approved_ideas.each do |entry|
                  %tr
                    %td= entry['Poster']
                    %td= entry['Title']
                    %td #{entry['Support']}%
                    %td= entry['# of Comments']
                    %td= entry['# of Votes']
      .item
        .row.first-q
          .col-sm-6
            .summary-box
              .header Overview
              .body
                .col-sm-4
                  .summary-card
                    .main-content
                      = @stat_overview[:num_actionables]
                    /.notes
                    /  Total Number of
                    .footer
                      Viable Ideas
                .col-sm-4
                  .summary-card
                    .main-content
                      = @stat_overview[:num_total_ideas]
                    /.notes
                    /  Total Number of
                    .footer
                      Total Ideas
                .col-sm-4
                  .summary-card
                    .main-content
                      = @stat_overview[:num_approved]
                    /.notes
                    /  Total Number of
                    .footer
                      Approved Ideas
                .col-sm-4
                  .summary-card
                    .main-content
                      = @stat_overview[:num_comments]
                    /.notes
                    /  Total Number of
                    .footer
                      Total Comments
                .col-sm-4
                  .summary-card
                    .main-content
                      = @stat_overview[:num_votes]
                    /.notes
                    /  Total Number of
                    .footer
                      Total Votes
                .col-sm-4
                  .summary-card
                    .main-content
                      = @stat_overview[:num_users]
                    /.notes
                    /  Total Number of
                    .footer
                      Total Users
          .col-sm-6
            .summary-box
              .header Chart
              .body
                .graph_cover
                  Not Enough Data
                #detailed_trends_graph.d3_graph



    -#   %table#personnel-table.table.table-striped.display{cellspacing: "0", width: "100%"}
    -#     %thead.text-center
    -#       %th Username
    -#       %th First Name
    -#       %th Last Name
    -#       %th Job Title
    -#       %th # Posts
    -#       %th # Comments
    -#       / %th # Doits
    -#       %th Opinions Given (<u>Total</u>/+/-)
    -#       %th Opinions Received (<u>+</u>/-/Total)
    -#     %tbody.text-center
    -#       - @users.each do |user|
    -#         %tr
    -#           %td= user.username
    -#           %td= user.first_name
    -#           %td= user.last_name
    -#           %td= user.job_title
    -#           %td
    -#             #{user.posts.count}
    -#           %td
    -#             #{user.comments.count}
    -#           / %td
    -#            #{user.posts.all_doits.count + user.comments.all_doits.count}
    -#           %td
    -#             (<b>#{user.contributions['total']}</b>/#{user.contributions['positive']}/#{user.contributions['negative']})
    -#           %td
    -#             (<b>#{user.impact['positive']}</b>/#{user.impact['negative']}/#{user.impact['total']})
